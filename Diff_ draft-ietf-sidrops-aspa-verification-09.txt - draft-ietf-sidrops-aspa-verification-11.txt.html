<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0028)https://www.ietf.org/rfcdiff -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
   
  <meta http-equiv="Content-Style-Type" content="text/css"> 
  <title>Diff: draft-ietf-sidrops-aspa-verification-09.txt - draft-ietf-sidrops-aspa-verification-11.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
    span.hide { display: none; color: #aaa;}    a:hover span { display: inline; }    tr.change { background-color: gray; } 
    tr.change a { text-decoration: none; color: black } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('tr[id$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk;
    old_chunk.style.outline = "1px solid red";
    window.location.hash = "#" + new_str;
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
</head> 
<body data-new-gr-c-s-check-loaded="14.1085.0" data-gr-ext-installed=""> 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tbody><tr id="part-1" bgcolor="orange"><th></th><th><a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-sidrops-aspa-verification-09.txt" style="color:#008; text-decoration:none;">&lt;</a>&nbsp;<a href="https://tools.ietf.org/html/draft-ietf-sidrops-aspa-verification-09.txt" style="color:#008">draft-ietf-sidrops-aspa-verification-09.txt</a>&nbsp;</th><th> </th><th>&nbsp;<a href="https://tools.ietf.org/html/draft-ietf-sidrops-aspa-verification-11.txt" style="color:#008">draft-ietf-sidrops-aspa-verification-11.txt</a>&nbsp;<a href="https://www.ietf.org/rfcdiff?url1=draft-ietf-sidrops-aspa-verification-11.txt" style="color:#008; text-decoration:none;">&gt;</a></th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0001"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">Network Working Group                                    <span class="delete">A. Azimov (Ed.)</span></td><td> </td><td class="rblock">Network Working Group                                    <span class="insert">      A. Azimov</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Internet-Draft                                                    Yandex</td><td> </td><td class="right">Internet-Draft                                                    Yandex</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Intended status: Standards Track                            E. Bogomazov</td><td> </td><td class="right">Intended status: Standards Track                            E. Bogomazov</td><td class="lineno"></td></tr>
      <tr id="diff0002"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">Expires: <span class="delete">12 January 2023</span>                                     Qrator Labs</td><td> </td><td class="rblock">Expires: <span class="insert">27 April 2023  </span>                                     Qrator Labs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                                 R. Bush</td><td> </td><td class="right">                                                                 R. Bush</td><td class="lineno"></td></tr>
      <tr id="diff0003"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                      <span class="delete">Internet Initiative Japan</span> &amp; Arrcus</td><td> </td><td class="rblock">                                      <span class="insert">                      IIJ</span> &amp; Arrcus</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                                K. Patel</td><td> </td><td class="right">                                                                K. Patel</td><td class="lineno"></td></tr>
      <tr id="diff0004"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                            <span class="delete">Arrcus, Inc.</span></td><td> </td><td class="rblock">                                                            <span class="insert">      Arrcus</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                             J. Snijders</td><td> </td><td class="right">                                                             J. Snijders</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                                                                  Fastly</td><td> </td><td class="right">                                                                  Fastly</td><td class="lineno"></td></tr>
      <tr id="diff0005"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                            <span class="delete">11 July</span> 2022</td><td> </td><td class="rblock">                                                               <span class="insert">K. Sriram</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                USA NIST</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                         24 October</span> 2022</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">  BGP AS_PATH Verification Based on Resource Public Key Infrastructure</td><td> </td><td class="right">  BGP AS_PATH Verification Based on Resource Public Key Infrastructure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     (RPKI) Autonomous System Provider Authorization (ASPA) Objects</td><td> </td><td class="right">     (RPKI) Autonomous System Provider Authorization (ASPA) Objects</td><td class="lineno"></td></tr>
      <tr id="diff0006"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                draft-ietf-sidrops-aspa-verification-<span class="delete">09</span></td><td> </td><td class="rblock">                draft-ietf-sidrops-aspa-verification-<span class="insert">11</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document defines the semantics of an Autonomous System Provider</td><td> </td><td class="right">   This document defines the semantics of an Autonomous System Provider</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Authorization object in the Resource Public Key Infrastructure to</td><td> </td><td class="right">   Authorization object in the Resource Public Key Infrastructure to</td><td class="lineno"></td></tr>
      <tr id="diff0007"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   verify the AS_PATH attribute of <span class="delete">routes</span> advertised <span class="delete">in the Border</span></td><td> </td><td class="rblock">   verify the <span class="insert">Border Gateway Protocol (BGP)</span> AS_PATH attribute of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Gateway Protocol.</span>  This AS_PATH verification is primarily intended</td><td> </td><td class="rblock">   advertised <span class="insert">routes.</span>  This <span class="insert">type of</span> AS_PATH verification is primarily</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   for detection and mitigation of route leaks.  It also provides</td><td> </td><td class="rblock">   intended for detection and mitigation of route leaks.  It also <span class="insert">to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   protection against forged-origin prefix hijacks.</td><td> </td><td class="rblock"><span class="insert">   some degree</span> provides protection against forged-origin prefix hijacks.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Requirements Language</td><td> </td><td class="right">Requirements Language</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td> </td><td class="right">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td> </td><td class="right">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   capitals, as shown here.</td><td> </td><td class="right">   capitals, as shown here.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Status of This Memo</td><td> </td><td class="right">Status of This Memo</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-2" class="change"><td></td><th><small>skipping to change at</small><a href="https://www.ietf.org/rfcdiff#part-2"><em> page 2, line 4<span class="hide"> ¶</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="https://www.ietf.org/rfcdiff#part-2"><em> page 2, line 9<span class="hide"> ¶</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Internet-Drafts are draft documents valid for a maximum of six months</td><td> </td><td class="right">   Internet-Drafts are draft documents valid for a maximum of six months</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and may be updated, replaced, or obsoleted by other documents at any</td><td> </td><td class="right">   and may be updated, replaced, or obsoleted by other documents at any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   time.  It is inappropriate to use Internet-Drafts as reference</td><td> </td><td class="right">   time.  It is inappropriate to use Internet-Drafts as reference</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   material or to cite them other than as "work in progress."</td><td> </td><td class="right">   material or to cite them other than as "work in progress."</td><td class="lineno"></td></tr>
      <tr id="diff0008"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This Internet-Draft will expire on <span class="delete">12 January</span> 2023.</td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   This Internet-Draft will expire on <span class="insert">27 April</span> 2023.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Copyright (c) 2022 IETF Trust and the persons identified as the</td><td> </td><td class="right">   Copyright (c) 2022 IETF Trust and the persons identified as the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td> </td><td class="right">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   license-info) in effect on the date of publication of this document.</td><td> </td><td class="right">   license-info) in effect on the date of publication of this document.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Please review these documents carefully, as they describe your rights</td><td> </td><td class="right">   Please review these documents carefully, as they describe your rights</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and restrictions with respect to this document.  Code Components</td><td> </td><td class="right">   and restrictions with respect to this document.  Code Components</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   extracted from this document must include Revised BSD License text as</td><td> </td><td class="right">   extracted from this document must include Revised BSD License text as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   described in Section 4.e of the Trust Legal Provisions and are</td><td> </td><td class="right">   described in Section 4.e of the Trust Legal Provisions and are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provided without warranty as described in the Revised BSD License.</td><td> </td><td class="right">   provided without warranty as described in the Revised BSD License.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0009"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <span class="delete">2</span></td><td> </td><td class="rblock">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">3</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   2.  Anomaly Propagation . . . . . . . . . . . . . . . . . . . . .   3</td><td> </td><td class="right">   2.  Anomaly Propagation . . . . . . . . . . . . . . . . . . . . .   3</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   3.  Autonomous System Provider Authorization  . . . . . . . . . .   4</td><td> </td><td class="right">   3.  Autonomous System Provider Authorization  . . . . . . . . . .   4</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   4.  Customer-Provider Verification Procedure  . . . . . . . . . .   4</td><td> </td><td class="right">   4.  Customer-Provider Verification Procedure  . . . . . . . . . .   4</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   5.  AS_PATH Verification  . . . . . . . . . . . . . . . . . . . .   5</td><td> </td><td class="right">   5.  AS_PATH Verification  . . . . . . . . . . . . . . . . . . . .   5</td><td class="lineno"></td></tr>
      <tr id="diff0010"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     5.1.  <span class="delete">Upstream Paths</span>  . . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="rblock">     5.1.  <span class="insert">Definition of Indices . . .</span> . . . . . . . . . . . . . . .   <span class="insert">5</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     5.2.  <span class="delete">Downstream</span> Paths  . . . . . . . . . . . . . . . . . . . .   7</td><td> </td><td class="rblock"><span class="insert">       5.1.1.  RS-Client of a Non-Transparent RS . . . .</span> . . . . . .   6</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     <span class="delete">5.3.  Mitigation</span>  . . . . . . . . . . . . . . . . . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock">     5.2.  <span class="insert">Algorithm for Upstream</span> Paths  . . . . . . . . . . . . . .   <span class="insert">7</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   6.  <span class="delete">Disavowal of Provider Authorizaion</span>  . . . . . . . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock"><span class="insert">     5.3.  Algorithm for Downstream Paths  . . . . . . .</span> . . . . . .   7</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   7.  Mutual Transit (Complex Relations)  . . . . . . . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock">     <span class="insert">5.4.  ASPA Registration Recommendations</span> . . . . . . . . . . . .   <span class="insert">8</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   8.  Comparison to Peerlock  . . . . . . . . . . . . . . . . . . .   <span class="delete">9</span></td><td> </td><td class="rblock"><span class="insert">     5.5.  AS_PATH Verification Recommendation</span> . . . . . . . . . . .   <span class="insert">9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   9.  <span class="delete">Security</span> Considerations . . . . . . . . . . . . . . . . . . .   <span class="delete">9</span></td><td> </td><td class="rblock">   6.  <span class="insert">Mitigation</span>  . . . . . . . . . . . . . <span class="insert">. . . . . . . . . . . .   9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   10. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock">   7.  <span class="insert">Operational Considerations  . . . . . . . . . . . . . . . . .   9</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   11.</span> References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock"><span class="insert">     7.1.</span>  Mutual Transit (Complex Relations)  . . . . . . . . . . .  <span class="insert">10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     11.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock"><span class="insert">     7.2.  AS Confederations</span> . . <span class="insert">. . . . . . . . . . . . . . . . . .  10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     11.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock">   8.  Comparison to <span class="insert">Other Technologies  . . . . . . . . . . . . . .  10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">12</span></td><td> </td><td class="rblock"><span class="insert">     8.1.  BGPsec  . . . . . . . . . . . . . . . . . . . . . . . . .  10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     8.2.</span>  Peerlock  . . . . . . . . . . . . . . . . . . . <span class="insert">. . . . .  10</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   9.  <span class="insert">IANA</span> Considerations . . . . . . . . . . . . . . . . . . . <span class="insert">. .  11</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   10. <span class="insert">Security Considerations . . . . . . . . . . . . . . . . . . .  11</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   11.</span> Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   12.</span> References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     12.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     12.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">13</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">14</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0011"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The Border Gateway Protocol (BGP) was designed without mechanisms to</td><td> </td><td class="rblock">   The Border Gateway Protocol (BGP) <span class="insert">originally</span> was designed without</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   validate BGP <span class="delete">attributes.  Two consequences are</span> BGP <span class="delete">Hijacks</span> and BGP</td><td> </td><td class="rblock">   mechanisms to validate <span class="insert">whether the contents of attributes in</span> BGP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Route Leaks [RFC7908].</span>  BGP extensions are able to partially solve</td><td> </td><td class="rblock">   <span class="insert">UPDATEs conform to wishes of the involved Internet Number resource</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   these <span class="delete">problems.  For</span> example, <span class="delete">ROA-based Origin Validation</span> [RFC6483]</td><td> </td><td class="rblock"><span class="insert">   holders.  As a consequence</span> BGP <span class="insert">hijacks</span> and BGP <span class="insert">route leaks [RFC7908]</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   can be used to detect and filter accidental mis-originations, and</td><td> </td><td class="rblock"><span class="insert">   exist.  Some existing</span> BGP extensions are able to partially solve</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   [RFC9234] or [I-D.ietf-grow-route-leak-detection-mitigation] can be</td><td> </td><td class="rblock">   these <span class="insert">problems; for</span> example, <span class="insert">RPKI-based route origin validation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   used to detect accidental route leaks.  <span class="delete">While these upgrades to BGP</span></td><td> </td><td class="rblock"><span class="insert">   (RPKI-ROV)</span> [RFC6483] <span class="insert">[RFC6811] [RFC9319]</span> can be used to detect and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   are quite useful, they still rely on transitive BGP attributes, i.e.</span></td><td> </td><td class="rblock">   filter accidental mis-originations, and [RFC9234] or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   AS_PATH, that can be manipulated by attackers.</span></td><td> </td><td class="rblock">   [I-D.ietf-grow-route-leak-detection-mitigation] can be used to detect</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock">   <span class="insert">and mitigate</span> accidental route leaks.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   BGPsec [RFC8205] was designed to solve the problem of AS_PATH</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   validation using a cryptographic signatures included in the UPDATE.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Unfortunately, the cryptographic validation of path signatures</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   results in significant computational overhead for BGP routers.  More</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   importantly, while BGPsec offers protection against path or prefix</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   modifications, it does not protect against route leaks.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   An alternative approach was introduced with soBGP</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [I-D.white-sobgp-architecture].  Instead of strong cryptographic</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   AS_PATH validation, it created an AS_PATH security function based on</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   a shared database of AS adjacencies.  While such an approach has</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   reasonable computational cost, the two-side adjacencies don't provide</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   a way to automate anomaly detection without high adoption rate - an</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   attacker can easily create a one-way adjacency.  soBGP transported</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   data about adjacencies in new additional BGP messages, which was</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   recursively complex thus significantly increasing adoption</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   complexity.  In addition, the general goal of verification of all</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   AS_PATHs was not achievable given the indirect adjacencies at</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Internet exchange points.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0012"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Instead of strictly checking AS_PATH correctness, this document</span></td><td> </td><td class="rblock">   <span class="insert">This specification</span> focuses on solving <span class="insert">a number of</span> real-world</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   focuses on solving real-world operational <span class="delete">problems -</span> automatic</td><td> </td><td class="rblock">   operational <span class="insert">problems: the</span> automatic detection of route leaks and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   detection of route leaks and <span class="delete">combined with ROA detection of malicious</span></td><td> </td><td class="rblock">   <span class="insert">improbable BGP paths (including forged-origin BGP hijacks).</span>  To</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   bgp hijacks.</span>  To achieve this, new AS_PATH verification procedures</td><td> </td><td class="rblock">   achieve this, new AS_PATH verification procedures are described to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   are described to automatically detect invalid <span class="delete">(malformed)</span> AS_PATHs in</td><td> </td><td class="rblock">   automatically detect invalid AS_PATHs in announcements that are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   announcements that are received from customers, <span class="delete">peers,</span> providers,</td><td> </td><td class="rblock">   received from customers, <span class="insert">lateral peers (defined in [RFC7908]),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Route Servers (RSes), and RS-clients.  These procedures use a shared</td><td> </td><td class="rblock"><span class="insert">   transit</span> providers, Route Servers (RSes), and RS-clients.  These</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">signed</span> database of customer-to-provider relationships using a new</td><td> </td><td class="rblock">   procedures use a shared database of <span class="insert">cryptographically signed</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">RPKI object -</span> Autonomous System Provider Authorization <span class="delete">(ASPA).</span>  This</td><td> </td><td class="rblock">   customer-to-provider relationships using a new <span class="insert">Resource Public Key</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   technique provides benefits <span class="delete">for participants even during</span> early <span class="delete">and</span></td><td> </td><td class="rblock"><span class="insert">   Infrastructure (RPKI) Signed Object:</span> Autonomous System Provider</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   incremental adoption.</span></td><td> </td><td class="rblock">   Authorization <span class="insert">(ASPA) [I-D.ietf-sidrops-aspa-profile].</span>  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">incrementally deployable</span> technique provides benefits <span class="insert">to</span> early</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">adopters in context of limited deployment.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">2.  Anomaly Propagation</td><td> </td><td class="right">2.  Anomaly Propagation</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Both route leaks and hijacks have similar effects on ISP operations -</td><td> </td><td class="right">   Both route leaks and hijacks have similar effects on ISP operations -</td><td class="lineno"></td></tr>
      <tr id="diff0013"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   they redirect <span class="delete">traffic, resulting</span> in denial of service (DoS),</td><td> </td><td class="rblock">   they redirect <span class="insert">traffic which can result</span> in denial of service (DoS),</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   eavesdropping, increased <span class="delete">latency</span> and packet loss.  But the level of</td><td> </td><td class="rblock">   eavesdropping, increased <span class="insert">latency,</span> and packet loss.  But the level of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   risk depends significantly on the extent of propagation of the</td><td> </td><td class="right">   risk depends significantly on the extent of propagation of the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   anomalies.  For example, a hijack that is propagated only to</td><td> </td><td class="right">   anomalies.  For example, a hijack that is propagated only to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   customers may cause bottlenecking within a particular ISP's customer</td><td> </td><td class="right">   customers may cause bottlenecking within a particular ISP's customer</td><td class="lineno"></td></tr>
      <tr id="diff0014"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   cone, but if the anomaly <span class="delete">is propagated</span> through <span class="delete">peers, upstreams,</span> or</td><td> </td><td class="rblock">   cone, but if the anomaly <span class="insert">propagates</span> through <span class="insert">lateral (i.e., non-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   reaches <span class="delete">Tier-1</span> networks, <span class="delete">thus distributing globally,</span> the ill effects</td><td> </td><td class="rblock"><span class="insert">   transit) peers and transit providers,</span> or reaches <span class="insert">global distribution</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   will likely be experienced across continents.</td><td> </td><td class="rblock"><span class="insert">   through transit-free</span> networks, <span class="insert">then</span> the ill effects will likely be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   experienced across continents.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0015"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The ability to constrain propagation of BGP anomalies to <span class="delete">upstreams</span></td><td> </td><td class="rblock">   The ability to constrain propagation of BGP anomalies to <span class="insert">transit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   and <span class="delete">peers,</span> without requiring support from the source of the anomaly</td><td> </td><td class="rblock"><span class="insert">   providers</span> and <span class="insert">lateral peers -</span> without requiring support from the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   (which is critical if source has malicious <span class="delete">intent),</span> should</td><td> </td><td class="rblock">   source of the anomaly (which is critical if <span class="insert">the</span> source has malicious</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   significantly improve the security of <span class="delete">inter-domain</span> routing <span class="delete">and solve</span></td><td> </td><td class="rblock">   <span class="insert">intent) -</span> should significantly improve the security of <span class="insert">global inter-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the majority of problems.</span></td><td> </td><td class="rblock"><span class="insert">   domain</span> routing <span class="insert">system.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">3.  Autonomous System Provider Authorization</td><td> </td><td class="right">3.  Autonomous System Provider Authorization</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As described in [RFC6480], the RPKI is based on a hierarchy of</td><td> </td><td class="right">   As described in [RFC6480], the RPKI is based on a hierarchy of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   resource certificates that are aligned to the Internet Number</td><td> </td><td class="right">   resource certificates that are aligned to the Internet Number</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Resource allocation structure.  Resource certificates are X.509</td><td> </td><td class="right">   Resource allocation structure.  Resource certificates are X.509</td><td class="lineno"></td></tr>
      <tr id="diff0016"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   certificates that conform to the PKIX profile [RFC5280], <span class="delete">and to</span> the</td><td> </td><td class="rblock">   certificates that conform to the PKIX profile [RFC5280], <span class="insert">carrying</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   extensions for IP addresses and AS identifiers [RFC3779].  A resource</td><td> </td><td class="right">   extensions for IP addresses and AS identifiers [RFC3779].  A resource</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   certificate is a binding by an issuer of IP address blocks and</td><td> </td><td class="right">   certificate is a binding by an issuer of IP address blocks and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Autonomous System (AS) numbers to the subject of a certificate,</td><td> </td><td class="right">   Autonomous System (AS) numbers to the subject of a certificate,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   identified by the unique association of the subject's private key</td><td> </td><td class="right">   identified by the unique association of the subject's private key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   with the public key contained in the resource certificate.  The RPKI</td><td> </td><td class="right">   with the public key contained in the resource certificate.  The RPKI</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   is structured so that each current resource certificate matches a</td><td> </td><td class="right">   is structured so that each current resource certificate matches a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   current resource allocation or assignment.</td><td> </td><td class="right">   current resource allocation or assignment.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0017"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ASPA is digitally signed object that <span class="delete">bind,</span> for a selected AFI, a Set</td><td> </td><td class="rblock">   ASPA is <span class="insert">a</span> digitally signed object that <span class="insert">binds,</span> for a selected AFI, a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of Provider AS numbers to a Customer AS number (in terms of BGP</td><td> </td><td class="rblock">   Set of Provider AS numbers to a Customer AS number (in terms of BGP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">announcements</span> not <span class="delete">business),</span> and are signed by the holder of the</td><td> </td><td class="rblock">   <span class="insert">announcements,</span> not <span class="insert">business relationship),</span> and are signed by the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Customer AS.  An ASPA attests that a Customer AS holder (CAS) has</td><td> </td><td class="rblock">   holder of the Customer AS.  An ASPA attests that a Customer AS holder</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   authorized Set of Provider ASes (SPAS) to propagate the Customer's</td><td> </td><td class="rblock">   (CAS) has authorized <span class="insert">a</span> Set of Provider ASes (SPAS) to propagate the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">IPv4/IPv6</span> announcements onward, <span class="delete">e.g.</span> to the Provider's upstream</td><td> </td><td class="rblock">   Customer's <span class="insert">IPv4 or IPv6</span> announcements onward, <span class="insert">i.e.,</span> to the Provider's</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">providers</span> or <span class="delete">peers.</span>  The ASPA <span class="delete">record</span> profile is described in</td><td> </td><td class="rblock">   upstream <span class="insert">providers, lateral peers,</span> or <span class="insert">customers.</span>  The ASPA <span class="insert">object</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   [I-D.ietf-sidrops-aspa-profile].  <span class="delete">For a selected Customer AS SHOULD</span></td><td> </td><td class="rblock">   profile is described in [I-D.ietf-sidrops-aspa-profile].  In this</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   exist only single ASPA object at any time.</span>  In this <span class="delete">document we will</span></td><td> </td><td class="rblock">   <span class="insert">document, the</span> notation <span class="insert">(AS1, AFI, [AS2,...]) is used</span> to represent <span class="insert">the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   use ASPA(AS1, AFI, [AS2, ...]) as</span> notation to represent ASPA object</td><td> </td><td class="rblock">   ASPA object for AS1 in the selected AFI.  <span class="insert">In this example, AS2 and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   for AS1 in the selected AFI.</td><td> </td><td class="rblock"><span class="insert">   any other ASes listed in the square brackets represent the transit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provider ASes.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">4.  Customer-Provider Verification Procedure</td><td> </td><td class="right">4.  Customer-Provider Verification Procedure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0018"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This section describes <span class="delete">an abstract procedure that checks that</span> a pair</td><td> </td><td class="rblock">   This section describes a <span class="insert">procedure for checking if an ordered</span> pair of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   of <span class="delete">ASNs</span> (AS1, <span class="delete">AS2) is included in</span> the <span class="delete">set of signed ASPAs.  The</span></td><td> </td><td class="rblock">   <span class="insert">AS numbers (ASNs), e.g.,</span> (AS1, <span class="insert">AS2), has</span> the <span class="insert">property that AS2 is an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   semantics</span> of <span class="delete">its use</span> is <span class="delete">defined</span> in <span class="delete">next section.</span>  The procedure takes</td><td> </td><td class="rblock"><span class="insert">   attested provider</span> of <span class="insert">AS1 per ASPA.  This procedure</span> is <span class="insert">used in ASPA-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   (AS1, AS2, AFI) as input parameters and returns one of three <span class="delete">results:</span></td><td> </td><td class="rblock"><span class="insert">   based AS_PATH validation as described</span> in <span class="insert">Section 5.</span>  The procedure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   "Valid", <span class="delete">"Invalid"</span> and "Unknown".</td><td> </td><td class="rblock">   takes (AS1, AS2, AFI) as input parameters and returns one of three</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">possible results, which are</span> "Valid", <span class="insert">"Invalid",</span> and "Unknown".</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   A relying party (RP) must have access to a local cache of the</td><td> </td><td class="right">   A relying party (RP) must have access to a local cache of the</td><td class="lineno"></td></tr>
      <tr id="diff0019"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   complete set of cryptographically valid ASPAs when performing</td><td> </td><td class="rblock">   complete set of cryptographically valid ASPAs when performing<span class="insert"> the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   customer-provider verification procedure.</td><td> </td><td class="right">   customer-provider verification procedure.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The following algorithm describes the customer-provider verification</td><td> </td><td class="right">   The following algorithm describes the customer-provider verification</td><td class="lineno"></td></tr>
      <tr id="diff0020"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   procedure for selected AFI:</td><td> </td><td class="rblock">   procedure for <span class="insert">a </span>selected AFI:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0021"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   1.  Retrieve all cryptographically valid ASPAs <span class="delete">in a</span> selected AFI <span class="delete">with</span></td><td> </td><td class="rblock">   1.  Retrieve all cryptographically valid ASPAs <span class="insert">with the</span> selected AFI</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       a customer value of AS1.  The union of SPAS forms the set of</td><td> </td><td class="rblock">       <span class="insert">that have</span> a customer value of AS1.  The union of SPAS <span class="insert">from these</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       <span class="delete">"Candidate Providers."</span></td><td> </td><td class="rblock"><span class="insert">       ASPAs</span> forms the set of <span class="insert">authorized providers.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0022"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   2.  If the set of <span class="delete">Candidate Providers</span> is empty, then the procedure</td><td> </td><td class="rblock">   2.  If the set of <span class="insert">authorized providers</span> is empty, then the procedure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       exits with an outcome of <span class="delete">"Unknown."</span></td><td> </td><td class="rblock">       exits with an outcome of <span class="insert">"Unknown".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0023"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   3.  If AS2 is included in the <span class="delete">Candidate Providers,</span> then the procedure</td><td> </td><td class="rblock">   3.  If AS2 is included in the <span class="insert">set of authorized providers,</span> then the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       exits with an outcome of <span class="delete">"Valid."</span></td><td> </td><td class="rblock">       procedure exits with an outcome of <span class="insert">"Valid".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0024"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   4.  Otherwise, the procedure exits with an outcome of "Invalid<span class="delete">."</span></td><td> </td><td class="rblock">   4.  Otherwise, the procedure exits with an outcome of "Invalid<span class="insert">".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0025"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Since an <span class="delete">AS1</span> may have different <span class="delete">set</span> of providers <span class="delete">in</span> different AFI, it</td><td> </td><td class="rblock">   Since an <span class="insert">AS</span> may have different <span class="insert">sets</span> of providers <span class="insert">for</span> different AFI,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">should also</span> have different SPAS in corresponding ASPAs.  <span class="delete">In this</span></td><td> </td><td class="rblock">   <span class="insert">accordingly,</span> it <span class="insert">may</span> have different SPAS in <span class="insert">the</span> corresponding ASPAs.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   case,</span> the <span class="delete">output of this</span> procedure with input (AS1, AS2, AFI) may</td><td> </td><td class="rblock">   <span class="insert">Therefore,</span> the <span class="insert">above</span> procedure with <span class="insert">the</span> input (AS1, AS2, AFI) may</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   have different <span class="delete">output</span> for different AFI values.</td><td> </td><td class="rblock">   have different <span class="insert">outputs</span> for different AFI values.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.  AS_PATH Verification</td><td> </td><td class="right">5.  AS_PATH Verification</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0026"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">The procedures described in this document are applicable only to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   four-octet AS number compatible BGP speakers [RFC6793].  If such a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   BGP speaker receives both AS_PATH and AS4_PATH attributes in an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   UPDATE, then the procedures are applied on the reconstructed AS path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (Section 4.2.3 of [RFC6793]).  So, the term AS_PATH is used in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   document to refer to the usual AS_PATH [RFC4271] as well as the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reconstructed AS path (the latter in instances when reconstruction is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   performed).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If an attacker creates a route leak intentionally, they may try to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   strip their AS from the AS_PATH.  To partly guard against that, a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   check is necessary to match the most recently added AS in the AS_PATH</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to the BGP neighbor's ASN.  This check is expected to be performed as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   specified in Section 6.3 of [RFC4271].  If the check fails, then the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   AS_PATH is considered a Malformed AS_PATH and the UPDATE is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   considered to be in error (Section 6.3 of [RFC4271]).  It is expected</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that the case of transparent RS is appropriately taken care of (e.g.,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by suspending the check).  Note that the check fails also when the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   AS_PATH is empty (zero length) and that is appropriate.  These checks</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   are mentioned here because they are commonly a part of commercial BGP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   implementations and support the AS path validation procedures in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   document.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">5.1.  Definition of Indices</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The AS_PATH attribute identifies the autonomous systems through which</td><td> </td><td class="right">   The AS_PATH attribute identifies the autonomous systems through which</td><td class="lineno"></td></tr>
      <tr id="diff0027"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   an UPDATE message has passed.  <span class="delete">AS_PATH</span> may contain two types of</td><td> </td><td class="rblock">   an UPDATE message has passed.  <span class="insert">It</span> may contain two types of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   components: AS_SEQUENCEs and AS_SETs, as defined in [RFC4271].</td><td> </td><td class="right">   components: AS_SEQUENCEs and AS_SETs, as defined in [RFC4271].</td><td class="lineno"></td></tr>
      <tr id="diff0028"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">(Note: The consideration of AS Confederations is discussed in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 7.2.)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If the AS_PATH contains an AS_SET in any position, then it is marked</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by the verification algorithm as Invalid.  If the AS_PATH does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   contain an AS_SET but only AS_SEQUENCE(s), then it is represented for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   simplicity in the verification algorithm as a sequence of unique AS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   numbers: AS(1), AS(2),..., AS(I-1), AS(I), AS(I+1),..., AS(N), where</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   AS(1) is the rightmost (i.e., origin) AS and AS(N) is the leftmost,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   i.e., the neighbor of the validating AS.  N is the AS_PATH length in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   terms of the number of unique ASNs.  (Note: see Section 5.1.1 for the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   consideration of a special case.)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0029"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">We will use index of AS_PATH, where Seg(1) stands for</span> the <span class="delete">first</span></td><td> </td><td class="rblock">   <span class="insert">An Invalid Pair Index is determined as a minimal I such that</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   rightmost AS in</span> the <span class="delete">AS_PATH.  We will use Seg(I).value and</span></td><td> </td><td class="rblock">   <span class="insert">customer-provider validation procedure (Section 4) with parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Seg(I).type to represent Ith segment</span> value <span class="delete">and its type respectively.</span></td><td> </td><td class="rblock"><span class="insert">   (AS(I), AS(I+1), AFI) returns Invalid.  If there is no such minimal</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   I, then</span> the <span class="insert">Invalid Pair Index</span> value <span class="insert">is set equal to N.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0030"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">We define</span> Invalid Pair Index as <span class="delete">a minimal I such that Seg(I).type and</span></td><td> </td><td class="rblock">   <span class="insert">The Reverse</span> Invalid Pair Index <span class="insert">is determined</span> as the <span class="insert">Invalid Pair</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Seg(I+1).type equal to AS_SEQUENCE, Seg(I).value != Seg(I+1).value</span></td><td> </td><td class="rblock"><span class="insert">   Index calculated for the reversed version</span> of <span class="insert">the sequence AS(1),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and customer-provider validation procedure (Section 4) with</span></td><td> </td><td class="rblock"><span class="insert">   AS(2),..., AS(I-1), AS(I), AS(I+1),..., AS(N).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parameters (Seg(I).value, Seg(I+1).value, AFI) returns Invalid.  If I</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   index doesn't exist we put</span> the <span class="delete">length</span> of <span class="delete">AS_PATH in its value.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0031"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">We define Reverse Invalid</span> Pair Index as Invalid Pair Index <span class="delete">calculated</span></td><td> </td><td class="rblock">   <span class="insert">An Unknown</span> Pair Index <span class="insert">is determined</span> as <span class="insert">a minimal I such that the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   for a reversed AS_PATH.</span></td><td> </td><td class="rblock"><span class="insert">   customer-provider validation procedure (Section 4) with parameters</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (AS(I), AS(I+1), AFI) returns Unknown.  If there is no such minimal I</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   or the minimal I value is greater than the</span> Invalid Pair <span class="insert">Index, then</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the Unknown Pair</span> Index <span class="insert">value is set equal to the Invalid Pair Index.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0032"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">We define</span> Unknown Pair Index <span class="delete">as a minimal I Seg(I).type and</span></td><td> </td><td class="rblock">   <span class="insert">The Reverse</span> Unknown Pair Index is <span class="insert">determined as the Unknown</span> Pair</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Seg(I+1).type equal to AS_SEQUENCE, Seg(I).value != Seg(I+1).value</span></td><td> </td><td class="rblock">   Index <span class="insert">calculated for</span> the <span class="insert">reversed version</span> of <span class="insert">the sequence AS(1),</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and customer-provider validation procedure (Section 4) with</span></td><td> </td><td class="rblock"><span class="insert">   AS(2),..., AS(I-1), AS(I), AS(I+1),..., AS(N).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parameters (Seg(I).value, Seg(I+1).value, AFI) returns Unknown.  If I</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   is <span class="delete">greater than Invalid</span> Pair Index <span class="delete">or I doesn't exist we equate its</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   value to</span> the <span class="delete">value</span> of <span class="delete">Invalid Pair Index.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0033"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">We define Reverse Unknown Pair Index as Unknown Pair Index calculated</span></td><td> </td><td class="rblock">   <span class="insert">The procedures described in Section 5.2 and Section 5.3 make use of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   for a reversed AS_PATH.</span></td><td> </td><td class="rblock"><span class="insert">   the four Indices defined above.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0034"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The below procedures are applicable only for 32-bit AS number</span></td><td> </td><td class="rblock"><span class="insert">5.1.1.  RS-Client of a Non-Transparent RS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   compatible BGP speakers.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0035"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">5.1.  <span class="delete">Upstream Paths</span></td><td> </td><td class="rblock">   <span class="insert">A special consideration is given to the case when the validating AS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is an RS-client of a non-transparent Route Server (RS).  In this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   case, when the indices described Section 5.1 are computed, the ASN of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the RS is removed from the AS_PATH only for the purpose generating</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the sequence AS(1), AS(2),... , AS(I-1), AS(I), AS(I+1),..., AS(N)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that was defined in Section</span> 5.1.  <span class="insert">Thus, AS(N) would equal the AS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   number of the AS added just before the RS.  Also, N would be one less</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   than the AS_PATH length.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0036"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">When a route</span> is received from <span class="delete">a customer,</span> a lateral <span class="delete">peer, by a</span> RS or</td><td> </td><td class="rblock">   <span class="insert">Note that when an UPDATE</span> is received from <span class="insert">an IX RS, it is equivalent</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">RS-client at an IX, each consecutive AS_SEQUENCE pair MUST be equal</span></td><td> </td><td class="rblock"><span class="insert">   to coming from</span> a lateral <span class="insert">peer regardless of whether the</span> RS <span class="insert">is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   (prepend policy) or belong to customer-provider or mutual transit</span></td><td> </td><td class="rblock"><span class="insert">   transparent</span> or <span class="insert">not.  Hence, the Upstream path validation procedure</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   relationship</span> (Section <span class="delete">7).  If there are other types of relationships,</span></td><td> </td><td class="rblock">   (Section <span class="insert">5.2) can be applied at the receiving RS-client in both cases</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   it means</span> that the <span class="delete">route was leaked or</span> the AS_PATH <span class="delete">attribute was</span></td><td> </td><td class="rblock"><span class="insert">   (i.e., transparent and non-transparent RS) provided</span> that the <span class="insert">non-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   malformed and Invalid Pair Index will be less than AS_PATH length.</span></td><td> </td><td class="rblock"><span class="insert">   transparent RS AS is removed from</span> the AS_PATH <span class="insert">as described above</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   (preceding paragraph).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0037"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If an attacker creates route leak intentionally he may try to strip</span></td><td> </td><td class="rblock"><span class="insert">5.2.  Algorithm</span> for <span class="insert">Upstream Paths</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   his AS from the AS_PATH.  To strengthen route leak detection in case</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   of malicious activity we need to check that AS_PATH is not empty and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the latest AS in the AS_PATH equals to BGP neighbour AS with the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   exception</span> for <span class="delete">routes received from transparent IXes.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0038"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">At the of high adoption level there might be interest to distinguish</span></td><td> </td><td class="rblock">   <span class="insert">The upstream verification algorithm described here is applied when a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   between AS_PATHs that are Valid from AS_PATHs that can't be fully</span></td><td> </td><td class="rblock">   route is received from a <span class="insert">customer or</span> a lateral peer, or <span class="insert">by an RS-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   verified and may be leaked.  If</span> route is received from a <span class="delete">customer,</span> a</td><td> </td><td class="rblock"><span class="insert">   client</span> at an IX <span class="insert">RS.  Each hop AS(I)</span> to <span class="insert">AS(I+1)in the unique ASN</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   lateral peer, <span class="delete">by a RS</span> or <span class="delete">RS-client</span> at an IX <span class="delete">and Unknown Pair Index is</span></td><td> </td><td class="rblock"><span class="insert">   sequence AS(1), AS(2),... , AS(N) must be Valid per the customer-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   not equal</span> to AS_PATH <span class="delete">length it means that there is</span> at least one <span class="delete">AS</span></td><td> </td><td class="rblock"><span class="insert">   provider validation procedure (Section 4) for the</span> AS_PATH <span class="insert">to be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   without ASPA record.</span></td><td> </td><td class="rblock"><span class="insert">   Valid.  If</span> at least one <span class="insert">of those hops is Invalid, then the AS_PATH</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   would be Invalid.  If the AS_PATH verification outcome is neither</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Valid nor Invalid, then it would be evaluated as Unknown.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0039"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">goal of the</span> procedure <span class="delete">described below</span> is <span class="delete">to check the correctness</span></td><td> </td><td class="rblock">   The <span class="insert">upstream path verification</span> procedure is <span class="insert">specified as follows:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   of these statements.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0040"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   1.  If the AS_PATH has <span class="delete">zero length</span> then procedure halts with the</td><td> </td><td class="rblock">   1.  If the AS_PATH has <span class="insert">an AS_SET,</span> then <span class="insert">the</span> procedure halts with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       outcome <span class="delete">"Invalid";</span></td><td> </td><td class="rblock">       outcome <span class="insert">"Invalid".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0041"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   2.  If the <span class="delete">last segment in the AS_PATH has type AS_SEQUENCE and its</span></td><td> </td><td class="rblock">   2.  If the <span class="insert">Invalid Pair Index</span> is <span class="insert">less than N,</span> then <span class="insert">the</span> procedure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       value isn't equal to receiver's neighbor AS and receiver</span> is <span class="delete">not</span></td><td> </td><td class="rblock">       halts with the outcome <span class="insert">"Invalid".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       RS-client</span> then procedure halts with the outcome <span class="delete">"Invalid";</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0042"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   3.  If <span class="delete">Invalid</span> Pair Index is less than <span class="delete">AS_PATH length</span> then procedure</td><td> </td><td class="rblock">   3.  If <span class="insert">the Unknown</span> Pair Index is less than <span class="insert">N,</span> then <span class="insert">the</span> procedure</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       halts with the outcome <span class="delete">"Invalid";</span></td><td> </td><td class="rblock">       halts with the outcome <span class="insert">"Unknown".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0043"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   4.  <span class="delete">If</span> the <span class="delete">AS_PATH has at least one AS_SET segment then</span> procedure</td><td> </td><td class="rblock">   4.  <span class="insert">Else,</span> the procedure halts with the outcome <span class="insert">"Valid".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       halts with the outcome <span class="delete">"Unverifiable";</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0044"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">5.  If Unknown Pair Index is less than AS_PATH length then procedure</span></td><td> </td><td class="rblock"><span class="insert">5.3.  Algorithm for Downstream Paths</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       halts with the outcome "Unknown";</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0045"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">6.  Otherwise, the procedure halts with an outcome of "Valid".</span></td><td> </td><td class="rblock">   <span class="insert">The downstream verification algorithm described here is applied when</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a route is received from a transit provider.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0046"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.2.  Downstream Paths</span></td><td> </td><td class="rblock">   <span class="insert">Consider an UPDATE with the unique AS sequence AS(1), AS(2),... ,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   AS(N) as defined in Section 5.1.  When the UPDATE is received from a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provider, it may have both an upstream ramp (on the left) and a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   downstream ramp (on the right), where the downstream ramp follows the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   upstream ramp (both ramps are ASPA valid hop-by-hop).  The upstream</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ramp starts at AS(1) and each AS hop in it has the property that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   AS(i+1) is a provider of AS(i) per ASPA.  The downstream ramp ends at</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   AS(N) and each AS hop in it has the property that AS(i-1) is a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provider of AS(i) per ASPA.  The upstream ramp stops (reaches its</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   apex) when the ASPA validation to check customer-to-provider</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   relationship of the AS-pair corresponding to the next AS hop gives</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Invalid or Unknown result.  The apex of the downstream ramp is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   determined similarly but by doing the checks backwards starting with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the hop from AS(N-1) to AS(N).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0047"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">When a route</span> is <span class="delete">received from provider it may have both Upstream and</span></td><td> </td><td class="rblock">   <span class="insert">If there</span> is an <span class="insert">upstream ramp but no downstream ramp</span> or <span class="insert">vice versa,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Downstream fragments, where a Downstream follows</span> an <span class="delete">Upstream</span></td><td> </td><td class="rblock"><span class="insert">   then clearly</span> the <span class="insert">UPDATE is valid (i.e., not a route leak).  However,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   fragment.  If the path differs from this rule it means that the route</span></td><td> </td><td class="rblock">   if <span class="insert">both ramps exist, then the UPDATE</span> is <span class="insert">Valid if and only if either</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   was leaked</span> or the <span class="delete">AS_PATH attribute was malformed.  This statement</span></td><td> </td><td class="rblock">   one <span class="insert">or zero</span> AS <span class="insert">hops exist</span> between the <span class="insert">apexes of</span> the <span class="insert">two ramps, i.e.,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   can be transformed into the next one:</span> if <span class="delete">there</span> is <span class="delete">at least</span> one AS</td><td> </td><td class="rblock"><span class="insert">   there</span> is <span class="insert">no AS between</span> the <span class="insert">apexes (see [sriram1]</span> for <span class="insert">formal proof).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   between the <span class="delete">first Upstream fragment and</span> the <span class="delete">last Downstream fragment</span></td><td> </td><td class="rblock"><span class="insert">   If there are one or more ASes between the apexes</span> of <span class="insert">the upstream</span> and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   it</span> is <span class="delete">a route leak.  The length of</span> the <span class="delete">first Upstream segment and</span></td><td> </td><td class="rblock">   <span class="insert">downstream ramps, then the UPDATE</span> is <span class="insert">a</span> route <span class="insert">leak (Invalid)</span> or the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   last Downstream segment are defined by Invalid Pair Index and Reverse</span></td><td> </td><td class="rblock">   <span class="insert">presence of a leak cannot be known using available ASPAs (Unknown)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Invalid Pair Index respectively.  Using these indexes we can define</span></td><td> </td><td class="rblock"><span class="insert">   [sriram1].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   next rule</span> for <span class="delete">route leak detection for routes received from</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   providers: if sum</span> of <span class="delete">Invalid Pair Index</span> and <span class="delete">Reverse Invalid Pair</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Index</span> is <span class="delete">less than AS_PATH length, than</span> route <span class="delete">was leaked</span> or the</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">AS_PATH attribute was malformed.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0048"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Likewise we did in case</span> of <span class="delete">Upstream Paths, we need to check that</span></td><td> </td><td class="rblock">   <span class="insert">The determination</span> of <span class="insert">a route leak (Invalid) UPDATE can be done with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   AS_PATH is not empty</span> and the <span class="delete">latest AS in</span> the AS_PATH <span class="delete">equals to BGP</span></td><td> </td><td class="rblock"><span class="insert">   the use of the Invalid Pair Index</span> and <span class="insert">Reverse Invalid Pair Index.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   neighbour AS.</span></td><td> </td><td class="rblock"><span class="insert">   The rule for Invalid determination is as follows: if</span> the <span class="insert">sum of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Invalid Pair Index and Reverse Invalid Pair Index is less than N,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   then route was leaked [sriram1] or</span> the AS_PATH <span class="insert">attribute was</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   malformed.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0049"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Similar to route leak detection, we can distinguish the Valid AS_PATH</span></td><td> </td><td class="rblock">   <span class="insert">The downstream path verification procedure</span> is <span class="insert">specified as follows:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   from Unknown one by checking that sum of Unknown Pair Index and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Reverse Unknown Pair Index</span> is <span class="delete">equal or greater than AS_PATH length.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0050"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">The goal of</span> the procedure <span class="delete">described below is to check</span> the <span class="delete">correctness</span></td><td> </td><td class="rblock">   <span class="insert">1.  If the AS_PATH has an AS_SET, then</span> the procedure <span class="insert">halts with</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   of these statements.</span></td><td> </td><td class="rblock">       <span class="insert">outcome "Invalid".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0051"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">1.</span>  If the <span class="delete">AS_PATH has zero length</span> then procedure halts with the</td><td> </td><td class="rblock">   <span class="insert">2.</span>  If the <span class="insert">sum of the Invalid Pair Index and the Reverse Invalid Pair</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       outcome <span class="delete">"Invalid";</span></td><td> </td><td class="rblock"><span class="insert">       Index is less than N,</span> then <span class="insert">the</span> procedure halts with the outcome</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">       <span class="insert">"Invalid".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0052"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">2.</span>  If <span class="delete">a route is received from a provider and</span> the <span class="delete">last segment in</span></td><td> </td><td class="rblock">   <span class="insert">3.</span>  If the <span class="insert">sum of</span> the <span class="insert">Unknown Pair Index</span> and <span class="insert">the Reverse Unknown Pair</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       the <span class="delete">AS_PATH has type AS_SEQUENCE</span> and <span class="delete">its value isn't equal to</span></td><td> </td><td class="rblock"><span class="insert">       Index is less than N,</span> then the procedure halts with the outcome</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       receiver's neighbor AS,</span> then the procedure halts with the outcome</td><td> </td><td class="rblock">       <span class="insert">"Unknown".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       <span class="delete">"Invalid";</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0053"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">3.  If sum of Invalid Pair Index and Reverse Invalid Pair Index is</span></td><td> </td><td class="rblock">   <span class="insert">4.  Else,</span> the procedure halts with the outcome <span class="insert">"Valid".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       less than AS_PATH length, then</span> the procedure halts with the</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       outcome <span class="delete">"Invalid".</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0054"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">4.  If the AS_PATH has at least one AS_SET segment then procedure</span></td><td> </td><td class="rblock"><span class="insert">5.4.  ASPA Registration Recommendations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">       halts with the outcome "Unverifiable";</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0055"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">5.  If sum of Unknown Pair Index and Unknown Invalid Pair Index</span> is</td><td> </td><td class="rblock">   <span class="insert">An ASPA</span> is <span class="insert">a positive attestation that an AS holder has authorized</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       <span class="delete">less than AS_PATH length, then</span> the <span class="delete">procedure halts with</span> the</td><td> </td><td class="rblock"><span class="insert">   its providers to redistribute received routes to</span> the <span class="insert">provider's</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">       <span class="delete">outcome "Unknown".</span></td><td> </td><td class="rblock"><span class="insert">   providers and lateral peers.  This does not preclude</span> the <span class="insert">provider AS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from redistribution to its other customers.  An AS number resource</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   holder in its role as Customer, MUST register each of its transit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provider ASes in its ASPA record.  Operators SHOULD endeavour to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   register all providers in a single ASPA object at any time.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0056"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">6.  Otherwise,</span> the <span class="delete">procedure halts with</span> an <span class="delete">outcome of "Valid".</span></td><td> </td><td class="rblock">   <span class="insert">Registration of an ASPA (AS, AFI, [0]) and no other ASPAs is meant to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   be a statement by</span> the <span class="insert">registering AS that it has no transit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   providers.  An RS AS MUST register</span> an <span class="insert">AS 0 ASPA and MUST NOT register</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   any other ASPAs.  Normally, so-called "Tier-1" ASes do not have</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transit providers.  However, if a Tier-1 AS is present at an IX RS as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   an RS-client, then it MUST register an ASPA showing the RS AS as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   provider.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0057"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">5.3.  Mitigation</span></td><td> </td><td class="rblock">   <span class="insert">An ASPA (AS, AFI, [0]) SHOULD be the only ASPA registered by an AS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that intends declare that it is provider-free in the selected AFI.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If AS 0 coexists with other provider ASes in the same ASPA (or other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ASPA records in the same AFI), then the presence of the AS 0 has no</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   effect on the AS_PATH verification procedures.  The validation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   procedures simply consider the other (distinct from AS 0) providers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as the authorized providers of the AS in consideration.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0058"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If the output of the</span> AS_PATH <span class="delete">verification procedure is "Invalid" the</span></td><td> </td><td class="rblock"><span class="insert">5.5.</span>  AS_PATH <span class="insert">Verification Recommendation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   route MUST be rejected.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0059"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">If</span> the <span class="delete">output of the AS_PATH verification procedure is 'Unverifiable'</span></td><td> </td><td class="rblock">   <span class="insert">A compliant AS MUST apply</span> the <span class="insert">upstream</span> and <span class="insert">downstream AS path</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   it means that AS_PATH can't be fully checked.  Such routes should be</span></td><td> </td><td class="rblock"><span class="insert">   validation algorithms (Section 5.2 and Section 5.3, respectively) in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   treated with caution</span> and <span class="delete">SHOULD be processed the same way</span> as</td><td> </td><td class="rblock"><span class="insert">   principle producing outcomes</span> as <span class="insert">specified though the implementation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">"Invalid" routes.  This policy goes with full correspondence to</span></td><td> </td><td class="rblock"><span class="insert">   details may differ.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [I-D.kumari-deprecate-as-set-confed-set].</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0060"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The <span class="delete">above AS_PATH verification procedure is able to check routes</span></td><td> </td><td class="rblock">   The <span class="insert">procedures described in this document are applicable only for the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   received from customer, peers, providers, RS,</span> and <span class="delete">RS-clients.  The</span></td><td> </td><td class="rblock"><span class="insert">   address families AFI 1 (IPv4)</span> and <span class="insert">AFI 2 (IPv6)</span> with <span class="insert">SAFI 1 (unicast)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   ASPA mechanism combined</span> with <span class="delete">BGP Roles [RFC9234] and ROA-based Origin</span></td><td> </td><td class="rblock"><span class="insert">   in both cases [IANA-AF].  The procedures MUST NOT be applied</span> to <span class="insert">other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Validation [RFC6483] can provide a fully automated solution</span> to <span class="delete">detect</span></td><td> </td><td class="rblock"><span class="insert">   address families by default.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and filter hijacks and route leaks, including malicious ones.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0061"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">6.  <span class="delete">Disavowal of Provider Authoriza</span>ion</td><td> </td><td class="rblock">6.  <span class="insert">Mitigat</span>ion</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0062"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An ASPA is a positive attestation that an AS holder has authorized</span></td><td> </td><td class="rblock">   <span class="insert">If</span> the <span class="insert">output</span> of the <span class="insert">AS_PATH verification procedure</span> is <span class="insert">"Invalid",</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   its providers to redistribute received routes to the provider's</span></td><td> </td><td class="rblock"><span class="insert">   then the route MUST be rejected.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   providers and peers.  This does not preclude</span> the <span class="delete">provider ASes from</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   redistribution to its other customers.  By creating an ASPA with</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   providers set</span> of <span class="delete">[0],</span> the <span class="delete">customer indicates that no provider should</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   further announce its routes.  Specifically, AS 0</span> is <span class="delete">reserved to</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   identify provider-free networks, Internet exchange meshes, etc.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0063"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">An ASPA(AS, AFI, [0]) is a statement by the customer AS that its</span></td><td> </td><td class="rblock">   <span class="insert">The above AS_PATH verification procedures (Section 5.2 and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   routes <span class="delete">should not be</span> received <span class="delete">by any relying party AS</span> from <span class="delete">any of its</span></td><td> </td><td class="rblock"><span class="insert">   Section 5.3) are able to check</span> routes received from <span class="insert">customers,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   customers or peers.</span></td><td> </td><td class="rblock"><span class="insert">   lateral peers, transit providers, RSes, and RS-clients.  The ASPA-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   based path verification mechanism combined with BGP Roles [RFC9234]</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and ROA-based Origin Validation [RFC6811] can provide a fully</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   automated solution to detect and filter hijacks and route leaks,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   including malicious ones (e.g., forged-origin hijacks).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0064"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">By convention, an ASPA(AS, AFI, [0]) should be the only ASPA issued</span></td><td> </td><td class="rblock"><span class="insert">7.  Operational Considerations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   by a given AS holder in the selected AFI; although this is not a</span></td><td> </td><td class="rblock"><span class="insert">7.1.  Mutual Transit (Complex Relations)</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   strict requirement.  An AS 0 may coexist with other provider ASes in</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   the same ASPA (or other ASPA records in the same AFI); though in such</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   cases, the presence or absence of the provider AS 0 in ASPA does not</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   alter the AS_PATH verification procedure.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0065"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">7.  Mutual Transit (Complex Relations)</span></td><td> </td><td class="rblock">   <span class="insert">There are peering relationships which cannot be described as strictly</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   simple peer-to-peer (i.e., lateral peers) or customer-to-provider.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An example is when both parties (ASes) treat each other as a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   customer, i.e., the customer-to-provider relationship applies in each</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   direction.  That is called a sibling relationship, and in such case,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   an ASPA (AS1, AFI, [AS2, ...]) must be created by AS1 and another</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ASPA (AS2, AFI, [AS1, ...]) must be created by AS2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0066"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">There are peering relationships which can not be described as</span></td><td> </td><td class="rblock"><span class="insert">7.2.  AS Confederations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   strictly simple peer-peer or customer-provider; e.g. when both</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   parties are intentionally sending prefixes received from each other</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   to their peers and/or upstreams.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0067"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">In this case, two corresponding records ASPA(AS1, AFI, [AS2, ...]),</span></td><td> </td><td class="rblock">   <span class="insert">The ASes on the boundary of an AS Confederation MUST register ASPAs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   ASPA(AS2, AFI, [AS1, ...]) must be created by AS1</span> and <span class="delete">AS2</span></td><td> </td><td class="rblock"><span class="insert">   using the Confederation's global ASN</span> and <span class="insert">the procedures for ASPA-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   respectively.</span></td><td> </td><td class="rblock"><span class="insert">   based AS path validation in this document are NOT RECOMMENDED for use</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   on eBGP links internal to the Confederation.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0068"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">8.  Comparison to <span class="delete">Peerlock</span></td><td> </td><td class="rblock">8.  Comparison to <span class="insert">Other Technologies</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0069"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">ASPA has much in common with [Peerlock].  Peerlock is a BGP</span></td><td> </td><td class="rblock"><span class="insert">8.1.  BGPsec</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Flexsealing [Flexsealing] protection mechanism commonly deployed by</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   global-scale Internet carriers to protect other large-scale carriers.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0070"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Peerlock, unfortunately, depends</span> on <span class="delete">a laborious manual process in</span></td><td> </td><td class="rblock">   <span class="insert">While the described upgrades to BGP are quite useful, they still rely</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   which <span class="delete">operators coordinate</span> the <span class="delete">distribution</span> of <span class="delete">unstructured Provider</span></td><td> </td><td class="rblock">   on <span class="insert">an unsigned transitive BGP attributes, e.g., AS_PATH,</span> which <span class="insert">can be</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Authorizations through out-of-band means</span> in <span class="delete">a many-to-many fashion.</span></td><td> </td><td class="rblock"><span class="insert">   manipulated by on-path attackers.  BGPsec [RFC8205] was designed to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   On the other hand, ASPA's use of PKIX [RFC5280] allows for automated,</span></td><td> </td><td class="rblock"><span class="insert">   solve</span> the <span class="insert">problem</span> of <span class="insert">AS_PATH validation using cryptographic</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   scalable, and ubiquitous deployment, making the</span> protection <span class="delete">mechanism</span></td><td> </td><td class="rblock"><span class="insert">   signatures contained</span> in <span class="insert">BGP UPDATE messages.  While BGPsec offers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   available to a wider range of Internet Number Resource holders.</span></td><td> </td><td class="rblock">   protection <span class="insert">against unauthorized path modifications, BGPsec by design</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   does not protect against route leaks.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0071"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">ASPA mechanics implemented in code instead of Peerlock AS_PATH</span></td><td> </td><td class="rblock">   <span class="insert">BGPsec</span> and <span class="insert">ASPA are complementary technologies.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   regular expressions also provides a way to detect anomalies coming</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   from transit providers</span> and <span class="delete">internet exchange route servers.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0072"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">ASPA is intended to be a complete solution and replacement for</span></td><td> </td><td class="rblock"><span class="insert">8.2.</span>  Peerlock</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   existing</span> Peerlock <span class="delete">deployments.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0073"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">9.  Security Considerations</td><td> </td><td class="rblock">   <span class="insert">The Peerlock mechanism [Peerlock] [Flexsealing] has a similar</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   objective as the APSA-based route leak protection mechanism described</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in this document.  It is commonly deployed by large Internet carriers</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to protect each other from route leaks.  Peerlock depends on a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   laborious manual process in which operators coordinate the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   distribution of unstructured Provider Authorizations through out-of-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   band means in a many-to-many fashion.  On the other hand, ASPA's use</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of the RPKI allows for automated, scalable, and ubiquitous</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   deployment, making the protection mechanism available to a wider</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   range of network operators.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The ASPA mechanism implemented in router code versus Peerlock's</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   AS_PATH regular expressions also provides a way to detect anomalies</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   propagated from transit providers and IX route servers.  ASPA is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   intended to be a complete solution and replacement for existing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Peerlock deployments.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">9.  <span class="insert">IANA Considerations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This document includes no request to IANA.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">10.</span>  Security Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The proposed mechanism is compatible only with BGP implementations</td><td> </td><td class="right">   The proposed mechanism is compatible only with BGP implementations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   that can process 32-bit ASNs in the AS_PATH.  This limitation should</td><td> </td><td class="right">   that can process 32-bit ASNs in the AS_PATH.  This limitation should</td><td class="lineno"></td></tr>
      <tr id="diff0074"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   not have a real effect on operations <span class="delete">- such</span> legacy BGP routers are</td><td> </td><td class="rblock">   not have a real effect on operations <span class="insert">since</span> legacy BGP routers are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   rare and <span class="delete">it's</span> highly unlikely that they support integration with the</td><td> </td><td class="rblock">   rare and <span class="insert">it is</span> highly unlikely that they support integration with the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   RPKI.</td><td> </td><td class="right">   RPKI.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0075"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   ASPA issuers should be aware of the <span class="delete">validation implication in issuing</span></td><td> </td><td class="rblock">   ASPA issuers should be aware of the <span class="insert">implications of the ASPA-based AS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   an ASPA - an ASPA implicitly invalidates</span> all routes passed to</td><td> </td><td class="rblock"><span class="insert">   path validation.  A downstream AS can apply the verification</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   upstream providers other than the provider <span class="delete">ASs</span> listed in the ASPA</td><td> </td><td class="rblock"><span class="insert">   mechanism and possibly invalidate and reject</span> all routes passed to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   record.  It is the <span class="delete">Customer AS's duty</span> to maintain a correct set of</td><td> </td><td class="rblock">   upstream providers other than the provider <span class="insert">ASes</span> listed in the ASPA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   providers in ASPA record(s).</td><td> </td><td class="rblock">   record.  It is the <span class="insert">responsibility of each compliant AS</span> to maintain a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   correct set of providers in <span class="insert">its</span> ASPA record(s).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0076"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">While it's not restricted, but it's</span> highly recommended <span class="delete">maintaining</span></td><td> </td><td class="rblock">   <span class="insert">It is</span> highly recommended <span class="insert">that a compliant</span> AS <span class="insert">should maintain</span> a single</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   for selected Customer</span> AS a single ASPA object that covers all its</td><td> </td><td class="rblock">   ASPA object that covers all its providers.  Such <span class="insert">a practice will help</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   providers.  Such <span class="delete">policy should</span> prevent race conditions during ASPA</td><td> </td><td class="rblock">   prevent race conditions during ASPA updates that might affect prefix</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   updates that might affect prefix propagation.  The software that</td><td> </td><td class="rblock">   propagation.  The software that provides hosting for ASPA records</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   provides hosting for ASPA records SHOULD support enforcement of this</td><td> </td><td class="rblock">   SHOULD support enforcement of this <span class="insert">practice.  During a</span> transition</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">rule.  In the case of the</span> transition process between different <span class="delete">CA</span></td><td> </td><td class="rblock">   process between different <span class="insert">certificate authority (CA)</span> registries, the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   registries, the ASPA records SHOULD be kept identical in all</td><td> </td><td class="rblock">   ASPA records SHOULD be kept identical in all registries.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   registries.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0077"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   While the <span class="delete">ASPA</span> is able to detect both mistakes and malicious activity</td><td> </td><td class="rblock">   While the <span class="insert">ASPA-based mechanism</span> is able to <span class="insert">generally</span> detect both</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">for</span> routes received from customers, RS-clients, or peers, it <span class="delete">provides</span></td><td> </td><td class="rblock">   mistakes and malicious activity <span class="insert">affecting</span> routes received from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   only detection of mistakes</span> for routes that are received from upstream</td><td> </td><td class="rblock">   customers, RS-clients, or <span class="insert">lateral</span> peers, it <span class="insert">might fail to detect some</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">providers and RS(s).</span></td><td> </td><td class="rblock"><span class="insert">   malicious path modifications</span> for routes that are received from</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   upstream <span class="insert">providers.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0078"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Since an upstream provider becomes a trusted point, it <span class="delete">will</span> be able</td><td> </td><td class="rblock">   Since an upstream provider becomes a trusted point, <span class="insert">in theory</span> it</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   to <span class="delete">send</span> hijacked prefixes of its customers or <span class="delete">send hijacked prefixes</span></td><td> </td><td class="rblock">   <span class="insert">might</span> be able to <span class="insert">propagate without detection some instances of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   with malformed <span class="delete">AS_PATHs back.</span>  While it may happen in theory, <span class="delete">it's</span></td><td> </td><td class="rblock">   hijacked prefixes of its customers or <span class="insert">routes</span> with malformed <span class="insert">or</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   doesn't</span> seem to be a <span class="delete">real scenario: normally</span> customer and provider</td><td> </td><td class="rblock"><span class="insert">   manipulated AS_PATHs.</span>  While it may happen in theory, <span class="insert">it does not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   have a signed agreement and such policy violation should have legal</td><td> </td><td class="rblock">   seem to be a <span class="insert">realistic scenario.  Normally a</span> customer and <span class="insert">its transit</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   consequences or customer can just drop <span class="delete">relation</span> with such a provider</td><td> </td><td class="rblock">   provider have a signed agreement and such <span class="insert">a</span> policy violation should</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   and remove the corresponding ASPA record.</td><td> </td><td class="rblock">   have legal consequences or customer can just drop <span class="insert">the relationship</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   with such a provider and remove the corresponding ASPA record.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0079"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">1<span class="delete">0</span>.  Acknowledgments</td><td> </td><td class="rblock">1<span class="insert">1</span>.  Acknowledgments</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0080"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   The authors wish to thank authors of [RFC6483] since its text was</td><td> </td><td class="rblock">   The authors wish to thank <span class="insert">the</span> authors of [RFC6483] since its text was</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   used as an example while writing this document.  The authors wish to</td><td> </td><td class="rblock">   used as an example while writing <span class="insert">Section 3 in</span> this document.  <span class="insert">Thanks</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   thank Iljitsch van Beijnum for <span class="delete">giving</span> a <span class="delete">hint</span> about <span class="delete">Downstream</span> paths.</td><td> </td><td class="rblock"><span class="insert">   are also due to Jakob Heitz, Ben Maddison, Jeff Haas, and Nick</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Authors wish to thank Kotikalapudi Sriram for algorithm improvements</span></td><td> </td><td class="rblock"><span class="insert">   Hilliard for comments and discussion about the algorithms.</span>  The</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   and helping with text clarity in the document.</span></td><td> </td><td class="rblock">   authors wish to thank Iljitsch van Beijnum for <span class="insert">providing</span> a <span class="insert">suggestion</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   about <span class="insert">downstream</span> paths.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0081"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">1<span class="delete">1</span>.  References</td><td> </td><td class="rblock">1<span class="insert">2</span>.  References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0082"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">1<span class="delete">1</span>.1.  Normative References</td><td> </td><td class="rblock">1<span class="insert">2</span>.1.  Normative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td> </td><td class="right">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Requirement Levels", BCP 14, RFC 2119,</td><td> </td><td class="right">              Requirement Levels", BCP 14, RFC 2119,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC2119, March 1997,</td><td> </td><td class="right">              DOI 10.17487/RFC2119, March 1997,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0083"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC4271]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Border Gateway Protocol 4 (BGP-4)", RFC 4271,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC4271, January 2006,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc4271&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Housley, R., and W. Polk, "Internet X.509 Public Key</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Infrastructure Certificate and Certificate Revocation List</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc5280&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [RFC6480]  Lepinski, M. and S. Kent, "An Infrastructure to Support</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Secure Internet Routing", RFC 6480, DOI 10.17487/RFC6480,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              February 2012, &lt;https://www.rfc-editor.org/info/rfc6480&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [RFC6793]  Vohra, Q. and E. Chen, "BGP Support for Four-Octet</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Autonomous System (AS) Number Space", RFC 6793,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC6793, December 2012,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc6793&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [RFC6811]  Mohapatra, P., Scudder, J., Ward, D., Bush, R., and R.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Austein, "BGP Prefix Origin Validation", RFC 6811,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC6811, January 2013,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc6811&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [RFC7908]  Sriram, K., Montgomery, D., McPherson, D., Osterweil, E.,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              and B. Dickson, "Problem Definition and Classification of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              BGP Route Leaks", RFC 7908, DOI 10.17487/RFC7908, June</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              2016, &lt;https://www.rfc-editor.org/info/rfc7908&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td> </td><td class="right">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,</td><td> </td><td class="right">              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td> </td><td class="right">              May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0084"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">1<span class="delete">1</span>.2.  Informative References</td><td> </td><td class="rblock">1<span class="insert">2</span>.2.  Informative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [Flexsealing]</td><td> </td><td class="right">   [Flexsealing]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              McDaniel, T., Smith, J., and M. Schuchard, "Flexsealing</td><td> </td><td class="right">              McDaniel, T., Smith, J., and M. Schuchard, "Flexsealing</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              BGP Against Route Leaks: Peerlock Active Measurement and</td><td> </td><td class="right">              BGP Against Route Leaks: Peerlock Active Measurement and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Analysis", November 2020,</td><td> </td><td class="right">              Analysis", November 2020,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://arxiv.org/pdf/2006.06576.pdf&gt;.</td><td> </td><td class="right">              &lt;https://arxiv.org/pdf/2006.06576.pdf&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [I-D.ietf-grow-route-leak-detection-mitigation]</td><td> </td><td class="right">   [I-D.ietf-grow-route-leak-detection-mitigation]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Sriram, K. and A. Azimov, "Methods for Detection and</td><td> </td><td class="right">              Sriram, K. and A. Azimov, "Methods for Detection and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Mitigation of BGP Route Leaks", Work in Progress,</td><td> </td><td class="right">              Mitigation of BGP Route Leaks", Work in Progress,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Internet-Draft, draft-ietf-grow-route-leak-detection-</td><td> </td><td class="right">              Internet-Draft, draft-ietf-grow-route-leak-detection-</td><td class="lineno"></td></tr>
      <tr id="diff0085"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              <span class="delete">mitigation-00, 19</span> April <span class="delete">2019, &lt;http://www.ietf.org/</span></td><td> </td><td class="rblock">              <span class="insert">mitigation-07, 26</span> April <span class="insert">2022,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              internet-drafts/draft-ietf-grow-route-leak-detection-</span></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.ietf.org/archive/id/draft-ietf-grow-route-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              mitigation-00.txt&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              leak-detection-mitigation-07.txt&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [I-D.ietf-sidrops-aspa-profile]</td><td> </td><td class="right">   [I-D.ietf-sidrops-aspa-profile]</td><td class="lineno"></td></tr>
      <tr id="diff0086"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Azimov, A., Uskov, E., Bush, R., <span class="delete">Patel, K.,</span> Snijders, J.,</td><td> </td><td class="rblock">              Azimov, A., Uskov, E., Bush, R., Snijders, J., Housley,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              <span class="delete">and R.</span> Housley, "A Profile for Autonomous System Provider</td><td> </td><td class="rblock">              <span class="insert">R., and B. Maddison,</span> "A Profile for Autonomous System</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              Authorization", Work in Progress, Internet-Draft, <span class="delete">draft-</span></td><td> </td><td class="rblock">              Provider Authorization", Work in Progress, Internet-Draft,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              ietf-sidrops-aspa-profile-00, 17 May 2019,</span></td><td> </td><td class="rblock">              <span class="insert">draft-ietf-sidrops-aspa-profile-10, 12 August 2022,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;http://www.ietf.org/internet-drafts/draft-ietf-sidrops-</span></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.ietf.org/archive/id/draft-ietf-sidrops-aspa-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              aspa-profile-00.txt&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              profile-10.txt&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [I-D.kumari-deprecate-as-set-confed-set]</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Kumari, W. and K. Sriram, "Deprecation of AS_SET and</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              AS_CONFED_SET in BGP", Work in Progress, Internet-Draft,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              draft-kumari-deprecate-as-set-confed-set-12, 2 July 2018,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;http://www.ietf.org/internet-drafts/draft-kumari-</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              deprecate-as-set-confed-set-12.txt&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0087"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[I-D.white-sobgp-architecture]</span></td><td> </td><td class="rblock">   <span class="insert">[IANA-AF]  IANA, "Address Family Numbers",</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              White, R., "Architecture and Deployment Considerations for</span></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.iana.org/assignments/address-family-numbers/</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Secure Origin BGP (soBGP)", Work in Progress, Internet-</span></td><td> </td><td class="rblock"><span class="insert">              address-family-numbers.xhtml&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Draft, draft-white-sobgp-architecture-02, 16 June 2006,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;http://www.ietf.org/internet-drafts/draft-white-sobgp-</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              architecture-02.txt&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [Peerlock] Snijders, J., "Peerlock", June 2016,</td><td> </td><td class="right">   [Peerlock] Snijders, J., "Peerlock", June 2016,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.nanog.org/sites/default/files/</td><td> </td><td class="right">              &lt;https://www.nanog.org/sites/default/files/</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Snijders_Everyday_Practical_Bgp.pdf&gt;.</td><td> </td><td class="right">              Snijders_Everyday_Practical_Bgp.pdf&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC3779]  Lynn, C., Kent, S., and K. Seo, "X.509 Extensions for IP</td><td> </td><td class="right">   [RFC3779]  Lynn, C., Kent, S., and K. Seo, "X.509 Extensions for IP</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Addresses and AS Identifiers", RFC 3779,</td><td> </td><td class="right">              Addresses and AS Identifiers", RFC 3779,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC3779, June 2004,</td><td> </td><td class="right">              DOI 10.17487/RFC3779, June 2004,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc3779&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc3779&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0088"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[RFC4271]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Border Gateway Protocol 4 (BGP-4)", RFC 4271,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              DOI 10.17487/RFC4271, January 2006,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;https://www.rfc-editor.org/info/rfc4271&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Housley, R., and W. Polk, "Internet X.509 Public Key</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Infrastructure Certificate and Certificate Revocation List</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              &lt;https://www.rfc-editor.org/info/rfc5280&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   [RFC6480]  Lepinski, M. and S. Kent, "An Infrastructure to Support</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              Secure Internet Routing", RFC 6480, DOI 10.17487/RFC6480,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              February 2012, &lt;https://www.rfc-editor.org/info/rfc6480&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC6483]  Huston, G. and G. Michaelson, "Validation of Route</td><td> </td><td class="right">   [RFC6483]  Huston, G. and G. Michaelson, "Validation of Route</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Origination Using the Resource Certificate Public Key</td><td> </td><td class="right">              Origination Using the Resource Certificate Public Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Infrastructure (PKI) and Route Origin Authorizations</td><td> </td><td class="right">              Infrastructure (PKI) and Route Origin Authorizations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              (ROAs)", RFC 6483, DOI 10.17487/RFC6483, February 2012,</td><td> </td><td class="right">              (ROAs)", RFC 6483, DOI 10.17487/RFC6483, February 2012,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6483&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6483&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0089"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">[RFC7908]  Sriram, K., Montgomery, D., McPherson, D., Osterweil, E.,</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              and B. Dickson, "Problem Definition and Classification of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              BGP Route Leaks", RFC 7908, DOI 10.17487/RFC7908, June</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">              2016, &lt;https://www.rfc-editor.org/info/rfc7908&gt;.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8205]  Lepinski, M., Ed. and K. Sriram, Ed., "BGPsec Protocol</td><td> </td><td class="right">   [RFC8205]  Lepinski, M., Ed. and K. Sriram, Ed., "BGPsec Protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Specification", RFC 8205, DOI 10.17487/RFC8205, September</td><td> </td><td class="right">              Specification", RFC 8205, DOI 10.17487/RFC8205, September</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              2017, &lt;https://www.rfc-editor.org/info/rfc8205&gt;.</td><td> </td><td class="right">              2017, &lt;https://www.rfc-editor.org/info/rfc8205&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC9234]  Azimov, A., Bogomazov, E., Bush, R., Patel, K., and K.</td><td> </td><td class="right">   [RFC9234]  Azimov, A., Bogomazov, E., Bush, R., Patel, K., and K.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Sriram, "Route Leak Prevention and Detection Using Roles</td><td> </td><td class="right">              Sriram, "Route Leak Prevention and Detection Using Roles</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              in UPDATE and OPEN Messages", RFC 9234,</td><td> </td><td class="right">              in UPDATE and OPEN Messages", RFC 9234,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC9234, May 2022,</td><td> </td><td class="right">              DOI 10.17487/RFC9234, May 2022,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc9234&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc9234&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0090"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC9319]  Gilad, Y., Goldberg, S., Sriram, K., Snijders, J., and B.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Maddison, "The Use of maxLength in the Resource Public Key</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Infrastructure (RPKI)", BCP 185, RFC 9319,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              DOI 10.17487/RFC9319, October 2022,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc9319&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [sriram1]  Sriram, K. and J. Heitz, "On the Accuracy of Algorithms</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              for ASPA Based Route Leak Detection", IETF SIDROPS</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Meeting, Proceedings of the IETF 110, March 2021,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://datatracker.ietf.org/meeting/110/materials/</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              slides-110-sidrops-sriram-aspa-alg-accuracy-01&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Alexander Azimov</td><td> </td><td class="right">   Alexander Azimov</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Yandex</td><td> </td><td class="right">   Yandex</td><td class="lineno"></td></tr>
      <tr id="diff0091"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Ulitsa Lva Tolstogo 16</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Moscow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   119021</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Russian Federation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: a.e.azimov@gmail.com</td><td> </td><td class="right">   Email: a.e.azimov@gmail.com</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Eugene Bogomazov</td><td> </td><td class="right">   Eugene Bogomazov</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Qrator Labs</td><td> </td><td class="right">   Qrator Labs</td><td class="lineno"></td></tr>
      <tr id="diff0092"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">1-y Magistralnyy tupik 5A</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Moscow</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   123290</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Russian Federation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: eb@qrator.net</td><td> </td><td class="right">   Email: eb@qrator.net</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Randy Bush</td><td> </td><td class="right">   Randy Bush</td><td class="lineno"></td></tr>
      <tr id="diff0093"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Internet Initiative Japan &amp; <span class="delete">Arrcus</span></td><td> </td><td class="rblock">   Internet Initiative Japan &amp; <span class="insert">Arrcus, Inc.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   5147 Crystal Springs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Bainbridge Island, Washington 98110</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   United States of America</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: randy@psg.com</td><td> </td><td class="right">   Email: randy@psg.com</td><td class="lineno"></td></tr>
      <tr id="diff0094"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">                                                                         </span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Keyur Patel</td><td> </td><td class="right">   Keyur Patel</td><td class="lineno"></td></tr>
      <tr id="diff0095"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Arrcus, Inc.</span></td><td> </td><td class="rblock">   <span class="insert">Arrcus</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2077 Gateway Place</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Suite #400</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   San Jose, CA 95119</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   United States of America</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: keyur@arrcus.com</td><td> </td><td class="right">   Email: keyur@arrcus.com</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Job Snijders</td><td> </td><td class="right">   Job Snijders</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Fastly</td><td> </td><td class="right">   Fastly</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Amsterdam</td><td> </td><td class="right">   Amsterdam</td><td class="lineno"></td></tr>
      <tr id="diff0096"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Netherlands</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Email: job@fastly.com</td><td> </td><td class="right">   Email: job@fastly.com</td><td class="lineno"></td></tr>
      <tr id="diff0097"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Kotikalapudi Sriram</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   USA National Institute of Standards and Technology</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   100 Bureau Drive</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Gaithersburg, MD 20899</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   United States of America</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Email: ksriram@nist.gov</span></td><td class="lineno"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr id="end" bgcolor="gray"><th colspan="5" align="center">&nbsp;End of changes. 97 change blocks.&nbsp;</th></tr>
     <tr class="stats"><td></td><th><i>329 lines changed or deleted</i></th><th><i> </i></th><th><i>429 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br>This html diff was produced by rfcdiff 1.48. The latest version is available from <a href="https://www.tools.ietf.org/tools/rfcdiff/">http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </tbody></table>
   
   
</body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>